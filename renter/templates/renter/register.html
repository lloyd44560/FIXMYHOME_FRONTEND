<!DOCTYPE html>
<html lang="en">

  <head>
      {% load static %}
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>Renter Registration - FixMyHome</title>
      <script src="https://cdn.tailwindcss.com"></script>
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
      <script src="{% static '/renter/js/property_report.js' %}"></script>
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>

<body class="bg-gray-100 min-h-screen flex flex-col">

    <!-- Navbar -->
    {% include 'renter/navbar.html' %}
   <main class="flex-grow flex items-center justify-center p-4">
        <div class="w-full max-w-xl bg-white p-6 rounded-lg shadow-md mt-12">

    <button
      type="button"
      id="backBtn"
      class="p-2 rounded-md text-blue-600 hover:text-blue-800 hover:bg-blue-100 disabled:opacity-50 disabled:pointer-events-none"
      disabled
      aria-label="Back"
    >
      <!-- Left arrow icon -->
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
           viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M15 19l-7-7 7-7" />
      </svg>
    </button>

    <h2 class="text-center text-2xl font-bold mb-6">Register as Renter</h2>

     <!-- Stepper -->
    <div class="flex justify-between mb-6">
      <div class="flex-1 flex flex-col items-center">
        <div id="step1-indicator" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-blue-600 text-white font-semibold">1</div>
        <span class="mt-2 text-sm font-medium text-gray-600">My Details</span>
      </div>
      <div class="flex-1 flex flex-col items-center">
        <div id="step2-indicator" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-300 text-gray-600">2</div>
        <span class="mt-2 text-sm font-medium text-gray-600">Agent Details</span>
      </div>
      <div class="flex-1 flex flex-col items-center">
        <div id="step3-indicator" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-300 text-gray-600">3</div>
        <span class="mt-2 text-sm font-medium text-gray-600">House Details</span>
      </div>
    </div>

    <form id="registrationForm" class="space-y-4" method="POST" style="height: 480px; overflow-y: auto;" action="{% url 'register_renter' %}" enctype="multipart/form-data">

    {% csrf_token %}
    <!-- Step 1 For Personal Details -->
    <div id="step1" class="space-y-4">
       <div class="mb-4">
      <label for="name" class="block text-gray-700 font-medium mb-2">Name*</label>
        <input
          type="text"
          name="name"
          id="name"
          placeholder="Name"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
        <p id="nameError" class="text-red-500 text-sm hidden">Name is required.</p>
    </div>

    <div class="mb-4">
      <label for="email" class="block text-gray-700 font-medium mb-2">Email*</label>
      <input type="email" name="email" id="email"  placeholder="Email" class="w-full border border-gray-300 rounded-md p-2"  oninput="validateFields()">
      <p id="emailError" class="text-red-500 text-sm hidden">Email is required.</p>
    </div>

    <div class="mb-4">
      <label for="phone" class="block text-gray-700 font-medium mb-2">Phone Number*</label>
        <input
          type="tel"
          name="phone"
          id="phone"
          placeholder="Phone Number"
          oninput="validateFields()"
          class="w-full border border-gray-300 rounded-md p-2"
        />
      <p id="phoneError" class="text-red-500 text-sm hidden">Phone Number is required.</p>
    </div>

    <div class="mb-4 relative">
      <label for="password" class="block text-gray-700 font-medium mb-2">Password*</label>
      <input
        id="password"
        name="password"
        type="password"
        placeholder="Password"
        oninput="validateFields()"
        class="w-full border border-gray-300 rounded-md p-2 pr-10"
      />
      <p id="passwordError" class="text-red-500 text-sm hidden">Passwords do not match.</p>
      <p id="matchError" class="text-red-500 text-sm hidden">Passwords do not match.</p>

      <button
        type="button"
        id="togglePassword"
        class="absolute right-2 top-9 text-sm text-gray-600"
      >
        Show
      </button>
    </div>

    <div class="mb-4 relative">
      <label for="confirmPassword" class="block text-gray-700 font-medium mb-2">Confirm Password*</label>
      <input
        id="confirmPassword"
        name="confirmPassword"
        type="password"
        placeholder="Confirm Password"
        oninput="validateFields()"
        class="w-full border border-gray-300 rounded-md p-2 pr-10"
      />
      <p id="matchError" class="text-red-500 text-sm hidden">Passwords do not match.</p>

      <button
        type="button"
        id="toggleConfirmPassword"
        class="absolute right-2 top-9 text-sm text-gray-600"
      >
        Show
      </button>
      </div>
    </div>

    <!-- Step 2 Agent Information -->
    <div id="step2" class="space-y-4 hidden">
      <div class="mb-4">
        <label for="company" class="block text-gray-700 font-medium mb-2">My Agent Company Name*</label>
        <input
          type="text"
          name="company"
          id="company"
          placeholder="Agent Company Name"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
      </div>
      <p id="companyError" class="text-red-500 text-sm hidden">Company Name is required.</p>

      <div class="mb-4">
        <label for="contactPerson" class="block text-gray-700 font-medium mb-2">Contact Person*</label>
        <input
          type="text"
          name="contactPerson"
          id="contactPerson"
          placeholder="Contact Person"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
      </div>
      <p id="contactPersonError" class="text-red-500 text-sm hidden">Contact Person is required.</p>

      <div class="mb-4">
        <label for="contactPerson" class="block text-gray-700 font-medium mb-2">Contact Email Adress*</label>
        <input
          type="email"
          name="contactPersonEmail"
          id="contactPersonEmail"
          placeholder="Contact Person Email Address"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
      </div>
      <p id="contactPersonEmailError" class="text-red-500 text-sm hidden">Contact Person Email is required.</p>

      <div class="mb-4">
        <label for="contactPhone" class="block text-gray-700 font-medium mb-2">Contact Phone Number*</label>
        <input
          type="tel"
          name="contactPhone"
          id="contactPhone"
          placeholder="Contact Phone Number"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
      </div>
      <p id="contactPhoneError" class="text-red-500 text-sm hidden">Contact Person Phone Number is required.</p>

      <div class="mb-4">
        <label for="contactPhone" class="block text-gray-700 font-medium mb-2">Company Address</label>
      </div>

      <div class="mb-4">
        <label for="state" class="block text-gray-700 font-medium mb-2">State*</label>
        <input
          type="text"
          name="state"
          id="state"
          placeholder="State"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
      </div>
      <p id="stateError" class="text-red-500 text-sm hidden">State is required.</p>

      <div class="mb-4">
        <label for="city" class="block text-gray-700 font-medium mb-2">City*</label>
        <input
          type="text"
          name="city"
          id="city"
          placeholder="City"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
      </div>

      <p id="cityError" class="text-red-500 text-sm hidden"> City is required. </p>

      <p id="zipError" class="text-red-500 text-sm hidden"> Zip Code is required. </p>

      <div class="mb-4">
        <label for="zip" class="block text-gray-700 font-medium mb-2">Address Line 1*</label>
        <input
          type="text"
          name="companyAddressLine1"
          id="companyAddressLine1"
          placeholder="Address Line 1"
          class="w-full border border-gray-300 rounded-md p-2"
          oninput="validateFields()"
        />
      </div>

      <p id="companyAddressLine1Error" class="text-red-500 text-sm hidden">Company Address Line is required </p>

      <div class="mb-4">
        <label for="zip" class="block text-gray-700 font-medium mb-2">Address Line 2 (optional)</label>
        <input
          type="text"
          name="companyAddressLine2"
          id="companyAddressLine2"
          placeholder="Address Line 2"
          class="w-full border border-gray-300 rounded-md p-2"
        />
      </div>

      <div class="mb-4">
        <label for="zip" class="block text-gray-700 font-medium mb-2">Postal Code</label>
        <input
          type="text"
          name="companyPostalCode"
          id="companyPostalCode"
          placeholder="Company Postal Code"
          class="w-full border border-gray-300 rounded-md p-2"
        />
      </div>
    </div>

     <!-- Step 3 Renter Reports -->
    <div id="step3" class="space-y-4 hidden">
      <div class="mb-4">
        <!-- <label for="uploadOption" class="block text-gray-700 font-medium mb-2">Select Step</label> -->
        <select name="uploadOption" id="uploadOption" class="w-full border border-gray-300 rounded-md p-2">
          <option value="">Select

            Your Reports
          </option>
          <option value="manual">Manually Upload Property Details</option>
          <option value="report">Upload Property Reports</option>
        </select>
      </div>

      <div id="manualUploadFields" class="space-y-4 hidden">
        <div class="mb-4">

          <label for="propertyImage" class="block text-gray-700 font-medium mb-2">Upload Property Photo</label>
           <img id="imagePreview" src="" alt="Property Image" class="w-full h-auto object-contain rounded mb-4 border border-gray-300" />

            <input
              type="file"
              name="propertyImage"
              id="propertyImage"
              class="block w-full text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded-md file:border-0
                file:text-sm file:font-semibold
                file:bg-blue-50 file:text-blue-700
                hover:file:bg-blue-100"
              accept="image/*"
              onchange="validateImageFile(this)"


            />

          <label for="propertyFile" class="block text-gray-700 font-medium mb-2">Upload Condition Report</label>

          <input
              type="file"
              name="propertyFile"
              id="propertyFile"
              accept="file/*"
              class="block w-full text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded-md file:border-0
                file:text-sm file:font-semibold
                file:bg-blue-50 file:text-blue-700
                hover:file:bg-blue-100"
              onchange="validateFileType(this)"
            />

          </div>
        <span id="fileTypeError" class="text-red-500 text-sm hidden">Invalid file type. Only PDF, DOC, DOCX, XLS, XLSX allowed.</span>
            <div class="mb-4">
              <label for="propertyName" class="block text-gray-700 font-medium mb-2">Property Name</label>
              <input type="text" name="propertyName" id="propertyName" placeholder="What is the name of the property?" class="w-full border border-gray-300 rounded-md p-2" />
            </div>

            <div class="mb-4">
              <label for="floorCount" class="block text-gray-700 font-medium mb-2">Floor Count</label>
                <input
                  type="number"
                  name="floorCount_manual"
                  id="floorCount_manual"
                  placeholder="How many floor is the property?"
                  class="w-full border border-gray-300 rounded-md p-2"
                  min="1"
                  onchange="validateFloorCount(this)"
                />
            </div>
            <div class="mb-4">
              <label for="leaseStart" class="block text-gray-700 font-medium mb-2">Property Lease Start</label>
                <input
                  type="date"
                  name="leaseStart_manual"
                  id="leaseStart_manual"
                  placeholder="Date of Property Lease Start?"
                  class="w-full border border-gray-300 rounded-md p-2"
                  min="1"
                  onchange="validateFloorCount(this)"
                />
            </div>

            <div class="mb-4">
              <label for="leaseEnd" class="block text-gray-700 font-medium mb-2">Property Lease End</label>
                <input
                  type="date"
                  name="leaseEnd_manual"
                  id="leaseEnd_manual"
                  placeholder="Date of Property Lease End?"
                  class="w-full border border-gray-300 rounded-md p-2"
                  min="1"
                  onchange="validateFloorCount(this)"
                />
            </div>
            <div class="mb-4">
              <label for="agent" class="block text-gray-700 font-medium mb-2">Select Agent</label>
              <select name="agent_id" id="agent_id" class="w-full border border-gray-300 rounded-md p-2">
                <option value="" disabled selected>Select an agent</option>
                {% for agent in agents %}
                  <option value="{{ agent.id }}">{{ agent.name }}</option>
                {% endfor %}
              </select>
            </div>
        <div class="mb-4">
          <label for="roomCount" class="block text-gray-700 font-medium mb-2">Room Count</label>
          <input type="number" name="roomCount_manual" id="roomCount_manual" placeholder="How many rooms are in the property?" class="w-full border border-gray-300 rounded-md p-2" />
        </div>
        <!-- Surround with blue highlight border -->
        <div class="mb-6">
          <label for="roomType" class="block text-gray-700 font-semibold mb-2">Rooms</label>

          <!-- Input and Add Button -->
          <div class="flex gap-2 mb-4">
            <input
              type="text"
              id="roomType"
              placeholder="Enter Room Type (e.g., Bedroom)"
              class="flex-1 border border-gray-300 rounded-md p-2"
            />
            <button
              type="button"
              id="addRoomBtn"
              class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700"
            >
              Add Room
            </button>
          </div>

          <!-- Room List -->
          <ul id="roomList" class="space-y-3">
            <input type="hidden" name="roomListData" id="roomListData">
            <!-- Dynamic items will be added here -->
          </ul>
        </div>

        <div class="mb-4">
          <label for="houseState" class="block text-gray-700 font-medium mb-2">State</label>
          <input type="text" name="houseState_manual" id="houseState_manual" placeholder="State" class="w-full border border-gray-300 rounded-md p-2" />
        </div>

        <div class="mb-4">
          <label for="houseCity" class="block text-gray-700 font-medium mb-2">City</label>
          <input type="text" name="houseCity_manual" id="houseCity_manual" placeholder="City" class="w-full border border-gray-300 rounded-md p-2" />
        </div>

        <div class="mb-4">
          <label for="address1" class="block text-gray-700 font-medium mb-2">Address Line 1</label>
          <input type="text" name="address1" id="address1" placeholder="Address Line 1" class="w-full border border-gray-300 rounded-md p-2" />
        </div>

        <div class="mb-4">
          <label for="address2" class="block text-gray-700 font-medium mb-2">Address Line 2(Optional)</label>
          <input type="text" name="address2" id="address2" placeholder="Address Line 2" class="w-full border border-gray-300 rounded-md p-2" />
        </div>

        <div class="mb-4">
          <label for="postalcode" class="block text-gray-700 font-medium mb-2">Postal Code</label>
          <input type="text" name="postalcode" id="postalcode" placeholder="Postal Code" class="w-full border border-gray-300 rounded-md p-2" />
        </div>
      </div>

        <!--Nga pala sir ito dapat magpapakita when  <select name="uploadOption" id="uploadOption" class="w-full border border-gray-300 rounded-md p-2">
          <option value="">Select

            Your Reports
          </option>
          <option value="manual">Manually Upload Property Details</option>
          <option value="report">Upload Property Reports</option>
        </select> is selected yung Upload Property Reports -->
        <div id="reportUploadFields" class="space-y-4 hidden flex flex-col items-start" style="text-align: center;">
          <p class="font-semibold mb-2">Select Your Reports</p>

            <div class="space-y-4">
                <button type="button" class="btn" data-bs-toggle="modal" data-bs-target="#conditionModal">
                    Condition Report
                </button>

                <!--<button type="button" class="applianceReportBtn w-full border border-blue-500 text-blue-500 bg-blue-100 py-3 px-4 rounded-md text-center">-->
                <!--    Appliance Report-->
                <!--</button>-->

                <!--<button type="button" onclick="openModal('maintenanceModal')" class="w-full border border-blue-500 text-blue-500 bg-blue-100 py-3 px-4 rounded-md text-center">-->
                <!--  Maintenance Report-->
                <!--</button>-->

                <!--<button type="button" onclick="openModal('standardModal')" class="w-full border border-blue-500 text-blue-500 bg-blue-100 py-3 px-4 rounded-md text-center">-->
                <!--  Minimum Standard Reports-->
                <!--</button>-->

            </div>


<script>
    document.addEventListener("DOMContentLoaded", function () {
      const roomsContainer = document.getElementById("roomsContainer");
      let nextRoomId = 1;

      function getNextRoomNumber() {
        const used = Array.from(roomsContainer.querySelectorAll(".room-block")).map(block => {
          return parseInt(block.dataset.roomIndex);
        });
        let i = 1;
        while (used.includes(i)) i++;
        return i;
      }

      window.addRoom = function () {
        const roomIndex = getNextRoomNumber();

        const roomHtml = `
          <div class="card mb-4 room-block" data-room-index="${roomIndex}" id="room_block_${roomIndex}">
            <div class="card-header d-flex justify-content-between align-items-center bg-light">
              <strong>Room ${roomIndex}</strong>
              <button type="button" class="btn btn-sm btn-danger" onclick="removeRoom(${roomIndex})">Remove Room</button>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label>Room Name</label>
                <input type="text" class="form-control" name="room_name_${roomIndex}" required>
              </div>

              <div class="mb-3">
                <label>Room Photo</label>
                <input type="file" class="form-control" name="room_photo_${roomIndex}" accept="image/*">
              </div>

              <div id="areaConditions_${roomIndex}"></div>

              <button type="button" class="btn btn-sm btn-outline-secondary" onclick="addAreaCondition(${roomIndex})">+ Add Area Condition</button>
            </div>
          </div>
        `;

        roomsContainer.insertAdjacentHTML('beforeend', roomHtml);
      };

      window.addAreaCondition = function (roomIdx) {
        const container = document.getElementById(`areaConditions_${roomIdx}`);
        const condCount = container.querySelectorAll('.condition-block').length;

        const conditionHtml = `
          <div class="border rounded p-3 mb-3 condition-block" id="condition_${roomIdx}_${condCount}">
            <div class="d-flex justify-content-between align-items-center">
              <h6>Condition ${condCount + 1}</h6>
              <button type="button" class="btn btn-outline-danger btn-sm" onclick="removeAreaCondition(${roomIdx}, ${condCount})">Remove</button>
            </div>
            <div class="row">
              <div class="col-md-4">
                <label>Area Name</label>
                <input type="text" class="form-control" name="area_name_${roomIdx}[]" required>
              </div>
              <div class="col-md-4">
                <label>Condition</label>
                <select class="form-control" name="condition_${roomIdx}[]" required>
                  <option value="Clean">Clean</option>
                  <option value="Undamaged">Undamaged</option>
                  <option value="Working">Working</option>
                </select>
              </div>
              <div class="col-md-4">
                <label>Remarks</label>
                <input type="text" class="form-control" name="remarks_${roomIdx}[]">
              </div>
              <div class="col-12 mt-2">
                <label>Upload Photo (Optional)</label>
                <input type="file" class="form-control" name="area_photo_${roomIdx}[]" accept="image/*">
              </div>
            </div>
          </div>
        `;

        container.insertAdjacentHTML('beforeend', conditionHtml);
      };

      window.removeRoom = function (roomIdx) {
        const roomBlock = document.getElementById(`room_block_${roomIdx}`);
        if (roomBlock) roomBlock.remove();
      };

      window.removeAreaCondition = function (roomIdx, condIdx) {
        const conditionBlock = document.getElementById(`condition_${roomIdx}_${condIdx}`);
        if (conditionBlock) conditionBlock.remove();
      };

      // Prevent modal form from submitting (for now)
      const conditionModal = document.getElementById("conditionModal");
      conditionModal.querySelector("form")?.addEventListener("submit", function (e) {
        e.preventDefault();
        console.log("Form submission prevented. You can handle saving manually here.");
      });
    });
</script>


   <!-- Room Condition Modal -->

    <div class="modal fade" id="conditionModal" tabindex="-1" aria-labelledby="conditionModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header bg-gray-100">
            <h5 class="modal-title" id="conditionModalLabel">Room Condition Report</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>

          <div class="modal-body">
            <!-- Property Info -->
            <div class="mb-3">
              <label>Property Name</label>
              <input type="text" class="form-control" name="property_name" required>
            </div>

            <!-- add the agent id pala dito sir -->
            <div class="mb-3">
              <label>Property Address</label>
              <input type="text" class="form-control" name="property_address" required>
            </div>
            <div class="row mb-3">
              <div class="col-md-6">
                <label>Lease Start</label>
                <input type="date" name="lease_start" class="form-control" required>
              </div>
              <div class="col-md-6">
                <label>Lease End</label>
                <input type="date" name="lease_end" class="form-control" required>
              </div>
            </div>

            <div class="mb-4">
                  <label for="agent" class="block text-gray-700 font-medium mb-2">Select Agent</label>
                  <select name="agent_id_condition" id="agent_id_condition" class="w-full border border-gray-300 rounded-md p-2">
                    <option value="" disabled selected>Select an agent</option>
                    {% for agent in agents %}
                      <option value="{{ agent.id }}">{{ agent.name }}</option>
                    {% endfor %}
                  </select>
                </div>

            <!-- Room & Area Conditions -->
            <div id="roomsContainer"></div>

            <button type="button" class="btn btn-outline-primary mt-3" onclick="addRoom()">+ Add Room</button>
          </div>

          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Save All</button>
          </div>
        </div>
      </div>
    </div>







    <!-- Appliance Report Modal -->

    <div id="applianceModal" class="modal hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
      <div class="bg-white w-full max-w-3xl p-6 rounded-xl shadow-xl overflow-y-auto max-h-[90vh]">
        <h2 class="text-lg sm:text-xl font-bold text-center text-gray-800 mb-4">Appliance Report</h2>

        <!-- Dynamic report container here -->
        <div id="applianceReportsContainer" class="space-y-6 mt-6"></div>

        <button type="button" onclick="handleSaveApplianceReport()" class="w-full mt-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium py-3 rounded-xl transition">
          Save Appliance Reports
        </button>
        <button type="button" onclick="closeModal('applianceModal')" class="w-full mt-6 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium py-3 rounded-xl transition">
          Close
        </button>


        <input name="applianceReports" id="applianceReportsInput">
      </div>
    </div>

    <!-- Maintenance Report Modal -->
    <div id="maintenanceModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white w-full max-w-xl p-6 rounded-xl shadow-lg overflow-y-auto max-h-[90vh]">
        <h2 class="text-lg font-bold mb-4 text-gray-800 text-center">Maintenance Report</h2>

        <!-- Maintenance form contents -->
        <form id="maintenanceForm" class="space-y-4">
          <div>
            <label class="block font-medium text-gray-700 mb-1">Room Name</label>
            <input type="text" class="w-full border border-gray-300 rounded-md p-2" placeholder="e.g., Kitchen" />
          </div>
          <div>
            <label class="block font-medium text-gray-700 mb-1">Issue Description</label>
            <textarea class="w-full border border-gray-300 rounded-md p-2 resize-none" rows="4" placeholder="Describe the maintenance issue..."></textarea>
          </div>
          <div>
            <label class="block font-medium text-gray-700 mb-1">Upload Photo (Optional)</label>
            <input type="file" class="w-full border border-gray-300 rounded-md p-2" />
          </div>
          <button type="button" onclick="submitMaintenanceReport()" class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 w-full">Submit</button>
        <!-- </form> -->

        <button type="button" onclick="closeModal('maintenanceModal')" class="mt-4 w-full text-center text-sm text-gray-600 hover:underline">Close</button>
      </div>
    </div>

      <!-- Minimum Standard Reports Modal -->
    <div id="standardModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-white w-full max-w-xl p-6 rounded-xl shadow-lg overflow-y-auto max-h-[90vh]">
        <h2 class="text-lg font-bold mb-4 text-gray-800 text-center">Minimum Standard Report</h2>



        <!-- New Additional Fields -->
        <div>
          <label class="block font-medium text-gray-700 mb-1 text-left block">Property Tenant’s Name</label>
          <input type="text" name="tenantName" class="w-full border border-gray-300 rounded-md p-2" />
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1 text-left block">Audit No. #</label>
          <input type="text" name="auditNo" class="w-full border border-gray-300 rounded-md p-2" />
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1 text-left block">Compliance Auditor</label>
          <input type="text" name="auditor" class="w-full border border-gray-300 rounded-md p-2" />
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1 text-left block">Inspection Address</label>
          <input type="text" name="inspectionAddress" class="w-full border border-gray-300 rounded-md p-2" />
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1 text-left block">Managing Agent</label>
          <input type="text" name="agent" class="w-full border border-gray-300 rounded-md p-2" />
        </div>
        <div>
          <label class="block font-medium text-gray-700 mb-1 text-left block">Audit Date</label>
          <input type="date" name="auditDate" class="w-full border border-gray-300 rounded-md p-2" />
        </div>

        <!-- Original Room-Level Report -->
        <div class="border-t border-gray-200 pt-4">
          <label class="block font-medium text-gray-700 mb-1 text-left block">Room</label>
          <input type="text" name="room" class="w-full border border-gray-300 rounded-md p-2" placeholder="e.g., Bedroom" />
        </div>

        <div>
          <label class="block font-medium text-gray-700 mb-1 text-left block">Comments</label>
          <textarea name="comments" class="w-full border border-gray-300 rounded-md p-2 resize-none" rows="4" placeholder="Any remarks..."></textarea>
        </div>

        <div>
          <label for="propertyFile" class="block text-gray-700 font-medium mb-2 text-left block">Upload Minimum Standard Report</label>

          <input
            type="file"
            name="propertyFile"
            id="propertyImage"
            accept="file/*"
            class="block w-full text-sm text-gray-500
              file:mr-4 file:py-2 file:px-4
              file:rounded-md file:border-0
              file:text-sm file:font-semibold
              file:bg-blue-50 file:text-blue-700
              hover:file:bg-blue-100"
          />
        </div>

        <input  name="standardReportData" id="standardReportDataInput">
        <button type="button" onclick="submitStandardReport()" class="bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 w-full">Save</button>
        <button onclick="closeModal('standardModal')" class="mt-4 w-full text-center text-sm text-gray-600 hover:underline">Close</button>

      </div>
    </div>

    <!-- All modals and forms related to the Condition Reports -->
    <!-- Add Category Modal -->
    <div id="addCategoryModal" class="modal hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50">
      <div class="bg-white w-full max-w-sm p-6 rounded-md shadow-md">
        <h2 class="text-lg font-bold mb-4 text-center">Add New Room Category</h2>
        <input id="newCategoryInput" type="text" placeholder="Enter new category"
          class="w-full border border-gray-300 rounded px-3 py-2 mb-4" />
        <div class="flex justify-end gap-2">
          <button type="button" onclick="closeAddCategoryModal()" class="px-4 py-2 bg-gray-300 rounded">Cancel</button>
          <button type="button" onclick="confirmAddCategory()" class="px-4 py-2 bg-blue-600 text-white rounded">Add</button>
        </div>
      </div>
    </div>

      <!-- Edit Category Name Modal -->
    <div id="editCategoryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
      <div class="bg-white p-6 rounded shadow-md w-full max-w-md">
        <h2 class="text-lg font-bold mb-4">Edit Room Details</h2>

        <label class="block mb-2 font-semibold">Room Name</label>
        <input id="editCategoryInput" type="text" class="w-full border p-2 mb-4" />
<!--
        <label class="block mb-2 font-semibold">Room Image</label>
        <input type="file" id="roomImageUpload" class="mb-4" /> -->

        <label class="block mb-2 font-semibold">Room Dimensions (ft)</label>
        <div class="flex gap-2 mb-4">
          <input id="roomWidth" type="number" placeholder="Width" class="w-1/2 border p-2" />
          <input id="roomLength" type="number" placeholder="Length" class="w-1/2 border p-2" />
        </div>

        <label class="block mb-2 font-semibold">Room Category</label>
        <select id="modalRoomCategory" class="w-full border p-2 mb-4"></select>
        <div class="mb-4">
        <label class="block mb-2 font-semibold">Room Areas</label>
        <div id="editRoomAreaTableWrapper">
            <!-- Table will be injected dynamically -->
      </div>
    </div>

     <div class="flex justify-end gap-2">
        <button type="button" onclick="closeEditModal()" class="text-gray-500">Cancel</button>
        <button type="button" onclick="saveEditedCategoryFromModal()" class="bg-blue-600 text-white px-4 py-2 rounded">Save</button>
      </div>
      </div>
    </div>

    </div>
    </div>

    <!-- Navigation Buttons -->
    <div class="flex justify-between">
      <!--<button type="button" id="prevBtn" class="px-4 py-2 bg-gray-300 rounded" disabled>Previous</button>-->

      <!-- Continue is type=button so no submit yet -->
      <button type="button" id="nextBtn" class="w-full px-4 py-2 bg-blue-600 text-white rounded">Continue</button>

      <!-- Submit button, initially hidden -->
      <button type="submit" id="submitBtn" class="w-full px-4 py-2 bg-green-600 text-white rounded hidden">Submit</button>
    </div>

      <!-- Login Link -->
              <p class="text-center text-sm mt-4">
                Already have an account?
                <a href="/login_renter/" class="text-blue-600 font-semibold hover:underline">Login Here</a>
              </p>
          </form>
        </div>
      </div>
    </main>
    <br>

    <script>
    // Script to collect the rooms stated in the Condition Report
    function collectRoomData() {
    const roomData = [];
    const roomBlocks = document.querySelectorAll("#roomContainer .mb-6");

    roomBlocks.forEach(roomDiv => {
    const photoInput = roomDiv.querySelector('.room-photo-input');
    const photoFile = photoInput ? photoInput.files[0] : null;

    const categoryName = roomDiv.querySelector(".category-name").textContent.trim();
    const width = roomDiv.getAttribute("data-width") || '';
    const length = roomDiv.getAttribute("data-length") || '';

    const areas = [];
    roomDiv.querySelectorAll("tbody tr").forEach(row => {
      const areaName = row.querySelector("td input")?.value || row.querySelector("td")?.textContent.trim();
      const status = [...row.querySelectorAll('input[type="checkbox"]')]
        .filter(cb => cb.checked)
        .map(cb => cb.value)[0] || '';

      const commentInput = row.querySelector("textarea");
      const renter_comment = commentInput ? commentInput.value.trim() : "";

      areas.push({ areaName, status, renter_comment });
    });

    roomData.push({
      categoryName,
      width,
      length,
      areas,
      photo: photoFile
    });
    });

      //  Collect additional fields from inputs
    const extraInfo = {
      condition_report_date: document.getElementById('conditionReportDate')?.value || '',
      agreement_start_date: document.getElementById('agreementStartDate')?.value || '',
      renter_received_date: document.getElementById('renterReceivedDate')?.value || '',
      report_return_date: document.getElementById('reportReturnDate')?.value || '',
      address: document.getElementById('conditionAddress')?.value || '',
      full_name_1: document.getElementById('fullName1')?.value || '',
      agent_name: document.getElementById('agentName')?.value || '',
      agent_company_name: document.getElementById('agentCompanyName')?.value || '',
      renter_1: document.getElementById('renter1')?.value || '',
      renter_2: document.getElementById('renter2')?.value || ''
    };

      //  Combine room data and extra info
    const fullData = {
      extraInfo: extraInfo,
      rooms: roomData
    };

      //  Store the full JSON in hidden input
    const conditionDataInput = document.getElementById("conditionDataInput");
    conditionDataInput.value = JSON.stringify(fullData);

    console.log("Full Condition Report Data:", fullData);

    //  Optional: Close modal after saving
    closeModal("conditionModal");

    return roomData;
    }

                // Dynamically generate list of cards with the room data based from the listing from the Condition Report

          function createApplianceReportCard(room, roomIndex) {
            return `
              <div class="appliance-card" data-room-index="${roomIndex}">
                <div class="border border-blue-200 p-4 rounded-xl shadow-sm space-y-4 bg-gray-50">
                  <h3 class="text-md font-semibold text-blue-600">${room.categoryName} - Appliance Report</h3>
                  <div class="grid grid-cols-1 gap-3">
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600 text-left block">Windows Height</label>
                      <input type="text" placeholder="e.g. 15.68 sq. ft." class="w-full px-3 py-2 rounded-xl border border-gray-300 text-sm" />
                    </div>
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600 text-left block">Windows Length</label>
                      <input type="text" value="${room.length}" placeholder="e.g. 4.72 sq. ft." class="w-full px-3 py-2 rounded-xl border border-gray-300 text-sm" />
                    </div>
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600 text-left block">Windows Width</label>
                      <input type="text" value="${room.width}" placeholder="e.g. 3.90 sq. ft." class="w-full px-3 py-2 rounded-xl border border-gray-300 text-sm" />
                    </div>
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600 text-left block">Appliance Brand</label>
                      <input type="text" class="w-full px-3 py-2 rounded-xl border border-gray-300 text-sm" />
                    </div>
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600 text-left block">Model/Serial Number</label>
                      <input type="text" class="w-full px-3 py-2 rounded-xl border border-gray-300 text-sm" />
                    </div>
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600 text-left block">Location in Room</label>
                      <input type="text" class="w-full px-3 py-2 rounded-xl border border-gray-300 text-sm" />
                    </div>
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600 text-left block">Appliance Photo</label>
                      <input
                        type="file"
                        name="appliance_photo_${roomIndex}"
                        class="appliance-photo-input w-full px-3 py-2 rounded-xl border border-gray-300 text-sm"
                        data-preview-id="appliancePreview_${roomIndex}"
                      />
                      <img
                        id="appliancePreview_${roomIndex}"
                        class="mt-2 w-full h-auto rounded border border-gray-200 object-contain max-h-48"
                        style="display: none;"
                      />
                    </div>
                    <div class="flex flex-col">
                      <label class="text-sm font-medium text-gray-600">Comments</label>
                      <textarea class="w-full px-3 py-2 rounded-xl border border-gray-300 text-sm resize-none"></textarea>
                    </div>
                  </div>
                </div>
              </div>
            `;
          }

      document.querySelector('.applianceReportBtn').addEventListener('click', function () {
      document.getElementById('applianceModal').classList.remove('hidden');

      function collectApplianceReports() {
        applianceReports = [];

        document.querySelectorAll('#applianceReportsContainer > div').forEach(card => {
        const inputs = card.querySelectorAll('input[type="text"]');
        const textarea = card.querySelector('textarea');

        applianceReports.push({
            roomName: card.querySelector('h3')?.textContent.split(' - ')[0].trim() || 'Unknown',
            window_height: inputs[0]?.value || '',
            window_length: inputs[1]?.value || '',
            window_width: inputs[2]?.value || '',
            brand: inputs[3]?.value || '',
            model_serial: inputs[4]?.value || '',
            location: inputs[5]?.value || '',
            comments: textarea?.value || ''
          });
        });

        console.log("Collected Appliance Reports:", applianceReports);

        const hiddenInput = document.getElementById('applianceReportsInput');
        if (hiddenInput) {
          hiddenInput.value = JSON.stringify(applianceReports);
        }
      }

      function attachApplianceListeners() {
          document.querySelectorAll('#applianceReportsContainer input, #applianceReportsContainer textarea')
            .forEach(input => {
              input.addEventListener('input', collectApplianceReports);
            });
      }


      document.querySelector('.applianceReportBtn').addEventListener('click', function () {
      document.getElementById('applianceModal').classList.remove('hidden');

      const rooms = collectRoomData(); // ← assume this function exists and works correctly
      console.log("Rooms Data:", rooms);

      const container = document.getElementById('applianceReportsContainer');
      container.innerHTML = '';

      if (!Array.isArray(rooms) || rooms.length === 0) {
        container.innerHTML = `<div class="text-center text-gray-500">No rooms added yet.</div>`;
        return;
      }

      rooms.forEach(room => {
        container.innerHTML += createApplianceReportCard(room);
      });

      attachApplianceListeners();
      collectApplianceReports();
      });

        const rooms = collectRoomData(); // collect room data
        console.log("Rooms Data:", rooms); //  log for debugging

        const container = document.getElementById('applianceReportsContainer');
        container.innerHTML = ''; // Clear container

        if (!Array.isArray(rooms) || rooms.length === 0) {
          container.innerHTML = `<div class="text-center text-gray-500">No rooms added yet.</div>`;
          return;
        }

        rooms.forEach(room => {
          container.innerHTML += createApplianceReportCard(room);
        });
      });

    function submitStandardReport() {
      const form = document.getElementById('registrationForm');

      const standardReport = {
        tenant_name: form.tenantName.value.trim(),
        audit_no: form.auditNo.value.trim(),
        auditor: form.auditor.value.trim(),
        inspection_address: form.inspectionAddress.value.trim(),
        managing_agent: form.agent.value.trim(),
        audit_date: form.auditDate.value,
        room: form.room.value.trim(),
        comments: form.comments.value.trim()
        // File will be handled in request.FILES
      };

      // Save JSON string to hidden input
      document.getElementById('standardReportDataInput').value = JSON.stringify(standardReport);
      console.log("Standard Report Data:", standardReport);

      }

    // Button to collect all Appliance Data
    function handleSaveApplianceReport() {
      applianceReports = [];

      document.querySelectorAll('#applianceReportsContainer > div').forEach(card => {
        const inputs = card.querySelectorAll('input[type="text"]');
        const textarea = card.querySelector('textarea');

        applianceReports.push({
          roomName: card.querySelector('h3')?.textContent.split(' - ')[0].trim() || 'Unknown',
          window_height: inputs[0]?.value || '',
          window_length: inputs[1]?.value || '',
          window_width: inputs[2]?.value || '',
          brand: inputs[3]?.value || '',
          model_serial: inputs[4]?.value || '',
          location: inputs[5]?.value || '',
          comments: textarea?.value || ''
        });
      });

      console.log("Collected Appliance Reports:", applianceReports);

      const hiddenInput = document.getElementById('applianceReportsInput');
      if (hiddenInput) {
        hiddenInput.value = JSON.stringify(applianceReports);
      }

      closeModal('applianceModal');
    }
    </script>

  <!-- All script files will be orgnanized later -->
    <script>
    // Tracking the current steps
    const steps = [document.getElementById('step1'), document.getElementById('step2'), document.getElementById('step3')];
    const stepIndicators = [
      document.getElementById('step1-indicator'),
      document.getElementById('step2-indicator'),
      document.getElementById('step3-indicator'),
    ];
    const backBtn = document.getElementById('backBtn');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn'); // New Submit button
    const uploadOption = document.getElementById('uploadOption');
    const manualUploadFields = document.getElementById('manualUploadFields');

    let currentStep = 0;

    function updateStep() {
      steps.forEach((step, index) => {
        step.classList.toggle('hidden', index !== currentStep);
        stepIndicators[index].classList.toggle('bg-blue-600', index === currentStep);
        stepIndicators[index].classList.toggle('text-white', index === currentStep);
        stepIndicators[index].classList.toggle('bg-gray-300', index !== currentStep);
        stepIndicators[index].classList.toggle('text-gray-600', index !== currentStep);
      });

    backBtn.disabled = currentStep === 0;

    if (currentStep === steps.length - 1) {
      // Last step: hide Next, show Submit
      nextBtn.classList.add('hidden');
      submitBtn.classList.remove('hidden');
    } else {
      // Other steps: show Next, hide Submit
      nextBtn.classList.remove('hidden');
      submitBtn.classList.add('hidden');
    }

    // Show manual upload fields only if on step 3 and option selected
    if (currentStep === 2) {
        if (uploadOption.value === 'manual') {
          manualUploadFields.classList.remove('hidden');
        } else {
          manualUploadFields.classList.add('hidden');
        }
      } else {
        manualUploadFields.classList.add('hidden');
      }
    }

    backBtn.addEventListener('click', () => {
      if (currentStep > 0) {
        currentStep--;
        updateStep();
      }
    });

    nextBtn.addEventListener('click', () => {
      if (currentStep < steps.length - 1) {
        currentStep++;
        updateStep();
      }
    });

    uploadOption.addEventListener('change', () => {
        if (currentStep === 2) {
          if (uploadOption.value === 'manual') {
            manualUploadFields.classList.remove('hidden');
            reportUploadFields.classList.add('hidden');
          } else if (uploadOption.value === 'report') {
            manualUploadFields.classList.add('hidden');
            reportUploadFields.classList.remove('hidden');
          } else {
            manualUploadFields.classList.add('hidden');
            reportUploadFields.classList.add('hidden');
          }
        }
      });

      // Password toggle
      const togglePassword = document.getElementById('togglePassword');
      const passwordInput = document.getElementById('password');
      togglePassword.addEventListener('click', () => {
        if (passwordInput.type === 'password') {
          passwordInput.type = 'text';
          togglePassword.textContent = 'Hide';
        } else {
          passwordInput.type = 'password';
          togglePassword.textContent = 'Show';
        }
      });

      const toggleConfirmPassword = document.getElementById('toggleConfirmPassword');
      const confirmPasswordInput = document.getElementById('confirmPassword');
      toggleConfirmPassword.addEventListener('click', () => {
        if (confirmPasswordInput.type === 'password') {
          confirmPasswordInput.type = 'text';
          toggleConfirmPassword.textContent = 'Hide';
        } else {
          confirmPasswordInput.type = 'password';
          toggleConfirmPassword.textContent = 'Show';
        }
      });



  // Form validation Here for required  fielda based on proposal
  const nameInput = document.getElementById("name");
  const nameError = document.getElementById("nameError");
  function validateFields() {
    const fields = [
      { id: "name", error: "nameError" },
      { id: "email", error: "emailError" },
      { id: "phone", error: "phoneError" },
      { id: "password", error: "passwordError" },
      { id: "confirmPassword", error: "confirmPasswordError" },
      { id: "company", error: "companyError" },
      { id: "contactPerson", error: "contactPersonError" },
      { id: "contactPersonEmail", error: "contactPersonEmailError" },
      { id: "contactPhone", error: "contactPhoneError" },
      { id: "state", error: "stateError" },
      { id: "city", error: "cityError" },
      { id: "zip", error: "zipError" },
      { id: "companyAddressLine1", error: "companyAddressLine1Error" },
      { id: "companyAddressLine2", error: "companyAddressLine2Error" },
    ];

    fields.forEach(({ id, error }) => {
      const input = document.getElementById(id);
      const errorMsg = document.getElementById(error);

      if (input && errorMsg) {
        if (input.value.trim() === "") {
          input.classList.add("border-red-500");
          errorMsg.classList.remove("hidden");
        } else {
          input.classList.remove("border-red-500");
          errorMsg.classList.add("hidden");
        }
      }
    });


    // Password strength validation
      const password = document.getElementById("password").value.trim();
      const passwordError = document.getElementById("passwordError");

      const strongPasswordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;

      if (!strongPasswordRegex.test(password)) {
        passwordError.textContent = "Password must be at least 8 characters long, include uppercase, lowercase, number, and special character.";
        passwordError.classList.remove("hidden");
        document.getElementById("password").classList.add("border-red-500");
      } else {
        passwordError.classList.add("hidden");
        document.getElementById("password").classList.remove("border-red-500");
      }


      // Password match validation
      const confirmPassword = document.getElementById("confirmPassword").value.trim();
      const matchError = document.getElementById("matchError");

      if (password && confirmPassword && password !== confirmPassword) {
        matchError.classList.remove("hidden");
        document.getElementById("confirmPassword").classList.add("border-red-500");
      } else {
        matchError.classList.add("hidden");
        document.getElementById("confirmPassword").classList.remove("border-red-500");
      }
    }
    document.getElementById('propertyImage').addEventListener('change', function(event) {
    const file = event.target.files[0];
    const preview = document.getElementById('imagePreview');

    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.src = e.target.result;
      };
      reader.readAsDataURL(file);
    } else {
      preview.src = '';
    }
  });

  // This part will be about submitting the Registration Form data
    document.getElementById("registrationForm").addEventListener("submit", function (e) {

    e.preventDefault(); // Prevent default form submission

    // normally collect information about the data

    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    const confirmPassword = document.getElementById("confirmPassword").value;
    const nameInput = document.getElementById("name");
    const nameError = document.getElementById("nameError");

    // Empty field check
    if (!name || !email || !password || !confirmPassword) {
        Swal.fire({
            icon: 'warning',
            title: 'Missing Fields',
            text: 'Please fill out all fields.',
        });
        return;
    }

    if (password !== confirmPassword) {
        Swal.fire({
            icon: 'error',
            title: 'Password Mismatch',
            text: 'Passwords do not match. Please try again.',
        });
        return;
    }

    Swal.fire({
        icon: 'success',
        title: 'Success!',
        text: 'Registration successful!',
      }).then(() => {
          // Now submit the form (with the hidden input included)
          e.target.submit();
      });
    });


  function openModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) {
        modal.classList.remove('hidden');
      }
    }

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      modal.classList.add('hidden');
    }
  }
    document.addEventListener("DOMContentLoaded", function () {
        const input = document.getElementById("propertyImage");
        const preview = document.getElementById("imagePreview");

        if (input && preview) {
          input.addEventListener("change", function (event) {
            const file = event.target.files[0];

            if (file && file.type.startsWith("image/")) {
              const reader = new FileReader();
              reader.onload = function (e) {
                preview.src = e.target.result;
              };
              reader.readAsDataURL(file);
            } else {
              preview.src = "";
            }
          });
        }
      });



    document.addEventListener("change", function (e) {
      const input = e.target;
      if (
        input.classList.contains("appliance-photo-input") ||
        input.classList.contains("room-photo-input")
      ) {
        const previewId = input.getAttribute("data-preview-id");
        const preview = document.getElementById(previewId);
        const file = input.files[0];

        if (file && preview) {
          const reader = new FileReader();
          reader.onload = function (event) {
            preview.src = event.target.result;
            preview.style.display = "block";
          };
          reader.readAsDataURL(file);
        } else if (preview) {
          preview.src = "";
          preview.style.display = "none";
        }
      }
    });


    document.addEventListener("change", function (e) {
      const input = e.target;
      if (
        input.classList.contains("room-photo-input") ||
        input.classList.contains("appliance-photo-input")
      ) {
        const previewId = input.getAttribute("data-preview-id");
        const preview = document.getElementById(previewId);
        const file = input.files[0];

        if (file && preview) {
          const reader = new FileReader();
          reader.onload = function (event) {
            preview.src = event.target.result;
            preview.style.display = "block";
          };
          reader.readAsDataURL(file);
        } else if (preview) {
          preview.src = "";
          preview.style.display = "none";
        }
      }
    });
document.addEventListener("DOMContentLoaded", function () {
  const addBtn = document.getElementById("addRoomAreaBtn");
  const tableBody = document.querySelector("#roomAreaTable tbody");

  if (addBtn && tableBody) {
    addBtn.addEventListener("click", function () {
      const newRow = document.createElement("tr");
      newRow.innerHTML = `
        <td><input type="text" placeholder="Area Name" class="border px-2 py-1 rounded" /></td>
        <td>
          <label><input type="checkbox" value="Clean" /> Clean</label>
          <label><input type="checkbox" value="Damaged" /> Damaged</label>
          <label><input type="checkbox" value="Needs Repair" /> Needs Repair</label>
        </td>
        <td><textarea class="border px-2 py-1 rounded w-full" placeholder="Comments"></textarea></td>
      `;
      tableBody.appendChild(newRow);
    });
  }
});

//   Validaton for number of floor Count
  function validateFloorCount(input) {
    const value = parseInt(input.value);
    if (isNaN(value) || value < 1) {
      alert("Floor Count must be at least 1.");
      input.value = ""; // Clear the invalid input
      input.focus();    // Bring focus back to the input
    }
  }

//
    function validateImageFile(input) {
      const file = input.files[0];
      if (file && !file.type.startsWith('image/')) {
        alert("Please upload a valid image file only (e.g. JPG, PNG).");
      input.value = ""; // clear the invalid file
    }
}


    function validateFileType(input) {
      const allowedExtensions = ['pdf', 'doc', 'docx', 'xls', 'xlsx'];
      const errorMsg = document.getElementById('fileTypeError');

      if (!input.files.length) return;

      const fileName = input.files[0].name;
      const fileExtension = fileName.split('.').pop().toLowerCase();

      if (!allowedExtensions.includes(fileExtension)) {
        input.value = ''; // Clear the selected file
        errorMsg.classList.remove('hidden');
      } else {
        errorMsg.classList.add('hidden');
      }
    }




    // document.getElementById("roomCount").addEventListener("input", handleRoomCountChange);

    // function handleRoomCountChange() {
    //   const roomCount = parseInt(document.getElementById("roomCount").value);
    //   const roomContainer = document.getElementById("roomContainer");

    //   // Clear current room blocks
    //   roomContainer.innerHTML = "";

    //   if (!isNaN(roomCount) && roomCount > 0) {
    //     // Dynamically create room categories like Room 1, Room 2, etc.
    //     for (let i = 1; i <= roomCount; i++) {
    //       const categoryName = `Room ${i}`;
    //       categories.push(categoryName);
    //       addRoomBlock(categoryName);
    //     }

    //     populateCategoryDropdown(); // Refresh dropdown with new rooms
    //   }
    // }



  </script>


  <!-- Footer -->
  {% include 'renter/home/footer.html' %}

</body>
</html>